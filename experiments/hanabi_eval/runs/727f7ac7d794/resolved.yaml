schema_version: 1
name: hanabi_eval
kind: rollout_eval
description: Baseline evaluation for Hanabi using a fixed protocol (repeatable across
  model/prompt changes).
tags:
- eval
- rollout
- hanabi
repro:
  seed: 0
  python: '>=3.10,<3.13'
spec:
  env_id: Hanabi-v0-train
  num_players: 2
  episodes: 20
  agents:
  - qwen:Qwen/Qwen3-VL-4B-Instruct
  - qwen:Qwen/Qwen3-VL-4B-Instruct
  system_prompt: 'You are an expert Hanabi teammate. Output exactly ONE valid action
    and nothing else. Valid formats: [Discard] X | [Play] X | [Reveal] player N card
    X color C | [Reveal] player N card X rank R'
  openai_base_url: http://127.0.0.1:8010/v1
  openai_api_key: dummy
  timeout_s: 120
  gen:
    temperature: 0.7
    top_p: 0.8
    top_k: 20
    repetition_penalty: 1.0
    presence_penalty: 1.5
    gen_seed: null
    extra_body: null
    chat_template_kwargs: null
    disable_thinking: false
commands:
- python tools/run_rollouts.py --env-id {spec.env_id} --num-players {spec.num_players}
  --episodes {spec.episodes} --seed {repro.seed} {agent_flags} --system-prompt {sh:spec.system_prompt}
  {opt:--openai-base-url spec.openai_base_url} {opt:--openai-api-key spec.openai_api_key}
  {opt:--timeout spec.timeout_s} --temperature {spec.gen.temperature} --top-p {spec.gen.top_p}
  {opt:--top-k spec.gen.top_k} {opt:--repetition-penalty spec.gen.repetition_penalty}
  {opt:--presence-penalty spec.gen.presence_penalty} {opt:--frequency-penalty spec.gen.frequency_penalty}
  {opt:--gen-seed spec.gen.gen_seed} {optsh:--extra-body spec.gen.extra_body} {optsh:--chat-template-kwargs
  spec.gen.chat_template_kwargs} {flag:--disable-thinking spec.gen.disable_thinking}
  {opt:--max-tokens spec.gen.max_tokens} --out {run_dir}/rollouts.jsonl
- python tools/summarize_rollouts.py {run_dir}/rollouts.jsonl --json > {run_dir}/summary.json
outputs:
  files:
  - '{run_dir}/rollouts.jsonl'
  - '{run_dir}/summary.json'
_resolved_commands:
- 'python tools/run_rollouts.py --env-id Hanabi-v0-train --num-players 2 --episodes
  20 --seed 0 --agent qwen:Qwen/Qwen3-VL-4B-Instruct --agent qwen:Qwen/Qwen3-VL-4B-Instruct
  --system-prompt ''You are an expert Hanabi teammate. Output exactly ONE valid action
  and nothing else. Valid formats: [Discard] X | [Play] X | [Reveal] player N card
  X color C | [Reveal] player N card X rank R'' --openai-base-url http://127.0.0.1:8010/v1
  --openai-api-key dummy --timeout 120 --temperature 0.7 --top-p 0.8 --top-k 20 --repetition-penalty
  1.0 --presence-penalty 1.5       --out experiments/hanabi_eval/runs/727f7ac7d794/rollouts.jsonl'
- python tools/summarize_rollouts.py experiments/hanabi_eval/runs/727f7ac7d794/rollouts.jsonl
  --json > experiments/hanabi_eval/runs/727f7ac7d794/summary.json
run_id: 727f7ac7d794
run_dir: experiments/hanabi_eval/runs/727f7ac7d794
